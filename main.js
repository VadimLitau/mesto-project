(()=>{"use strict";var e=function(e,t,o){fetch("https://nomoreparties.co/v1/plus-cohort-4/cards/likes/"+e,{method:t,headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f","Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json()})).then((function(e){o.textContent=e.likes.length}))},t=fetch("https://nomoreparties.co/v1/plus-cohort-4/cards",{headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f"}}),o=document.querySelector(".popup_AddCard"),n=document.querySelector(".profile__button"),r=document.querySelector(".popup_AddCard_cross"),c=document.querySelector("#photo-gallery__element").content,u=document.querySelector(".popup__form"),a=document.querySelector("#popup__idName"),i=document.querySelector("#popupAddCard__firstInput"),l=document.querySelector("#popupAddCard__secondInput"),p=document.querySelector(".gallery-element"),s=document.querySelector(".popup__photo"),d=document.querySelector(".popup__photo-image"),_=document.querySelector(".popup__photo-name"),f=(document.querySelector(".popup_photo_cross"),"3382b6ac0c72abf176e18b90"),m=document.querySelector(".popup_deleteCard"),v=(document.querySelector(".popup__deleteCard_btn"),function(t,o,n,r,u,a){var i=c.querySelector(".gallery-element__item").cloneNode(!0),l=i.querySelector(".gallery-element__photo"),p=i.querySelector(".gallery-element__caption-name"),v=i.querySelector(".gallery-element__caption-like"),y=i.querySelector(".gallery-element__deletCard"),q=i.querySelector(".gallery-element__like-counter");return l.alt=o,l.src=t,p.textContent=o,q.textContent=n,i.id=u,a&&v.classList.add("gallery-element__caption-like_active"),v.addEventListener("click",(function(){v.classList.contains("gallery-element__caption-like_active")?(e(u,"DELETE",q),v.classList.remove("gallery-element__caption-like_active")):(e(u,"PUT",q),v.classList.add("gallery-element__caption-like_active"))})),r===f?y.classList.remove("gallery-element__deletCard_notDelete"):y.classList.add("gallery-element__deletCard_notDelete"),y.addEventListener("click",(function e(){var t;t=i,document.querySelector(".popup__deleteCard_btn").addEventListener("click",(function e(){console.log(t.id),t.remove(),console.log("kurwa"),S(m),fetch("https://nomoreparties.co/v1/plus-cohort-4/cards/"+t.id,{method:"DELETE",headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f"}}),document.querySelector(".popup__deleteCard_btn").removeEventListener("click",e)})),h(m),y.removeEventListener("click",e)})),l.addEventListener("click",(function(){h(s),d.alt=l.alt,d.src=l.src,_.textContent=p.textContent})),i});function y(e){if("Escape"===e.key){var t=document.querySelector(".popup_opened");S(t)}}t.then((function(e){return e.json()})).then((function(e){e.reverse().forEach((function(e){var t;e.likes.forEach((function(e){return f===e._id?t=1:t})),p.prepend(v(e.link,e.name,e.likes.length,e.owner._id,e._id,t))}))}));var h=function(e){e.classList.add("popup_opened"),document.addEventListener("keydown",y)},S=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",y)},q=function(e,t){e.some((function(e){return!e.validity.valid}))?(t.classList.add(b.inactiveButtonClass),t.type="button"):(t.classList.remove(b.inactiveButtonClass),t.type="submit")},b={formSelector:".popup__form",inputSelector:".popup__form-input",submitButtonSelector:".popup__form-button",inactiveButtonClass:"popup__form-button_disabled",inputErrorClass:"popup__form-input_type_error",inputErrorClassActive:"popup__form-input-error_active",errorClass:"popup__error_visible"},C=document.querySelector(".profile__info-name"),L=document.querySelector(".profile__info-profession"),E=document.querySelector(".profile__info-button"),k=(document.querySelector(".popup__cross"),document.querySelector(".popup_profile")),g=document.querySelector("#popup__idProfession"),A=function(e,t,o,n){fetch("https://nomoreparties.co/v1/plus-cohort-4/users/me/"+t,{method:"PATCH",headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f","Content-Type":"application/json"},body:JSON.stringify({avatar:e,name:o.value,about:n.value})}).then((function(e){if(e.ok)return e.json()})).then((function(e){console.log(e),document.querySelector(".profile__avatar").src=e.avatar}))};document.querySelector(".profile__avatar").addEventListener("click",(function(){h(document.querySelector(".popup_editAvatar"))})),document.querySelector(".popup_editAvatar_btn").addEventListener("click",(function(){var e=document.querySelector("#popup_editAvatar").value;S(document.querySelector(".popup_editAvatar")),console.log(e),A(e,"avatar","","")})),document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup__cross")||t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__photo_wrap"))&&S(e)}))})),E.addEventListener("click",(function(){h(k),a.value=C.textContent,g.value=L.textContent})),n.addEventListener("click",(function(){h(o)})),u.addEventListener("submit",(function(e){A("","",a,g),C.textContent=a.value,L.textContent=g.value,S(k),e.preventDefault()})),r.addEventListener("click",(function(){S(o)})),o.addEventListener("submit",(function(e){var t,n;S(o),t=l.value,n=i.value,fetch("https://nomoreparties.co/v1/plus-cohort-4/cards",{method:"POST",headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f","Content-Type":"application/json"},body:JSON.stringify({name:n,link:t})}).then((function(e){if(e.ok)return e.json()})).then((function(e){p.prepend(v(e.link,e.name,"0",e.owner._id,e._id))})),l.value="",i.value="",document.querySelector(".popup_AddCard_form-button").classList.add("popup__form-button_disabled"),document.querySelector(".popup_AddCard_form-button").type="button",e.preventDefault()})),Array.from(document.querySelectorAll(b.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(b.inputSelector)),o=e.querySelector(b.submitButtonSelector);q(t,o),t.forEach((function(n){n.addEventListener("input",(function(){(function(e,t){t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(b.inputErrorClass),o.textContent="",o.classList.remove(b.inputErrorClassActive)}(e,t):function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add(b.inputErrorClass),n.textContent=o,n.classList.add(b.inputErrorClassActive)}(e,t,t.validationMessage)})(e,n),q(t,o)}))}))}(e)})),fetch("https://nomoreparties.co/v1/plus-cohort-4/users/me",{headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f"}}).then((function(e){return e.json()})).then((function(e){document.querySelector(".profile__info-name").textContent=e.name,document.querySelector(".profile__info-profession").textContent=e.about,document.querySelector(".profile__avatar").src=e.avatar}))})();