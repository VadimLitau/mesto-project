(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{h:()=>D});var t="https://nomoreparties.co/v1/plus-cohort-4",o="69b55c42-ee88-4348-a639-420f0f40fb4f";function n(e){return e.ok?e.json():Promise.reject("Ошибка ".concat(e.status))}var r=function(e,r,c,u){return fetch("".concat(t,"/users/me/")+r,{method:"PATCH",headers:{authorization:"".concat(o),"Content-Type":"application/json"},body:JSON.stringify({avatar:e,name:c.value,about:u.value})}).then(n)},c=function(e,r){return fetch("".concat(t,"/cards/likes/")+e,{method:r,headers:{authorization:"".concat(o),"Content-Type":"application/json"}}).then(n)},u=document.querySelector(".popup_AddCard"),a=document.querySelector(".profile__button"),i=document.querySelector(".popup_AddCard_cross"),l=document.querySelector("#photo-gallery__element").content,p=document.querySelector(".popup__form"),d=document.querySelector("#popup__idName"),s=document.querySelector("#popupAddCard__firstInput"),_=document.querySelector("#popupAddCard__secondInput"),m=document.querySelector(".gallery-element"),f=document.querySelector(".popup__photo"),y=document.querySelector(".popup__photo-image"),v=document.querySelector(".popup__photo-name"),S=(document.querySelector(".popup_photo_cross"),"3382b6ac0c72abf176e18b90"),q=document.querySelector(".popup_deleteCard"),h=(document.querySelector(".popup__deleteCard_btn"),function(e,o,r,u,a,i){var p=l.querySelector(".gallery-element__item").cloneNode(!0),d=p.querySelector(".gallery-element__photo"),s=p.querySelector(".gallery-element__caption-name"),_=p.querySelector(".gallery-element__caption-like"),m=p.querySelector(".gallery-element__deletCard"),h=p.querySelector(".gallery-element__like-counter");return d.alt=o,d.src=e,s.textContent=o,h.textContent=r,p.id=a,i&&_.classList.add("gallery-element__caption-like_active"),_.addEventListener("click",(function(){_.classList.contains("gallery-element__caption-like_active")?(c(a,"DELETE").then((function(e){h.textContent=e.likes.length})),_.classList.remove("gallery-element__caption-like_active")):(c(a,"PUT").then((function(e){h.textContent=e.likes.length})),_.classList.add("gallery-element__caption-like_active"))})),u===S?m.classList.remove("gallery-element__deletCard_notDelete"):m.classList.add("gallery-element__deletCard_notDelete"),m.addEventListener("click",(function(){var e,o;C(q),e=p,L(q),e.remove(),o=e.id,fetch("".concat(t,"/cards/")+o,{method:"DELETE",headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f"}}).then(n)})),d.addEventListener("click",(function(){C(f),y.alt=d.alt,y.src=d.src,v.textContent=s.textContent})),p});fetch("".concat(t,"/cards/"),{headers:{authorization:"69b55c42-ee88-4348-a639-420f0f40fb4f"}}).then(n).then((function(e){e.reverse().forEach((function(e){var t;e.likes.forEach((function(e){return S===e._id?t=1:t})),m.prepend(h(e.link,e.name,e.likes.length,e.owner._id,e._id,t))}))}));function b(e){if("Escape"===e.key){var t=document.querySelector(".popup_opened");L(t)}}var C=function(e){e.classList.add("popup_opened"),document.addEventListener("keydown",b)},L=function(e,t,o,n){t?(o.textContent=n,setTimeout((function(){e.classList.remove("popup_opened")}),t)):e.classList.remove("popup_opened"),document.removeEventListener("keydown",b)},E=function(e,t){e.some((function(e){return!e.validity.valid}))?(t.classList.add(g.inactiveButtonClass),t.type="button"):(t.classList.remove(g.inactiveButtonClass),t.type="submit")},g={formSelector:".popup__form",inputSelector:".popup__form-input",submitButtonSelector:".popup__form-button",inactiveButtonClass:"popup__form-button_disabled",inputErrorClass:"popup__form-input_type_error",inputErrorClassActive:"popup__form-input-error_active",errorClass:"popup__error_visible"},k=document.querySelector(".profile__info-name"),A=document.querySelector(".profile__info-profession"),x=document.querySelector(".profile__info-button"),T=(document.querySelector(".popup__cross"),document.querySelector(".popup_profile")),j=document.querySelector("#popup__idProfession");fetch("".concat(t,"/users/me"),{headers:{authorization:"".concat(o)}}).then(n).then((function(e){document.querySelector(".profile__info-name").textContent=e.name,document.querySelector(".profile__info-profession").textContent=e.about,document.querySelector(".profile__avatar").src=e.avatar}));var w=document.querySelector(".profile__avatar-wrap-edit"),D=2e3;w.addEventListener("click",(function(){C(document.querySelector(".popup_editAvatar")),document.querySelector(".popup_editAvatar_btn").textContent="Сохранить",document.querySelector(".popup_editAvatar_btn").type="button",document.querySelector(".popup_editAvatar_btn").classList.add("popup__form-button_disabled"),document.querySelector("#popup_editAvatar").value=""})),document.querySelector(".popup_editAvatar_btn").addEventListener("click",(function(){var e=document.querySelector("#popup_editAvatar").value;L(document.querySelector(".popup_editAvatar"),D,document.querySelector(".popup_editAvatar_btn"),"Сохранение..."),setTimeout((function(){r(e,"avatar","","").then((function(e){document.querySelector(".profile__avatar").src=e.avatar}))}),D)})),document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup__cross")||t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__photo_wrap"))&&L(e)}))})),x.addEventListener("click",(function(){C(T),d.value=k.textContent,j.value=A.textContent,document.querySelector(".popup__form-button_profile").textContent="Сохранить"})),a.addEventListener("click",(function(){C(u),_.value="",s.value="",document.querySelector(".popup_AddCard_form-button").textContent="Создать",document.querySelector(".popup_AddCard_form-button").classList.add("popup__form-button_disabled"),document.querySelector(".popup_AddCard_form-button").type="button"})),p.addEventListener("submit",(function(e){L(T,D,document.querySelector(".popup__form-button_profile"),"Сохранение..."),setTimeout((function(){r("","",d,j),k.textContent=d.value,A.textContent=j.value}),D),e.preventDefault()})),i.addEventListener("click",(function(){L(u)})),u.addEventListener("submit",(function(e){var r,c,a,i;L(u,D,document.querySelector(".popup_AddCard_form-button"),"Сохранение..."),r=_.value,c=s.value,a=D,function(e,r){return fetch("".concat(t,"/cards"),{method:"POST",headers:{authorization:"".concat(o),"Content-Type":"application/json"},body:JSON.stringify({name:r,link:e})}).then(n)}(r,c).then((function(e){return i=e})).finally(setTimeout((function(){m.prepend(h(i.link,i.name,"0",i.owner._id,i._id))}),a)),e.preventDefault()})),Array.from(document.querySelectorAll(g.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(g.inputSelector)),o=e.querySelector(g.submitButtonSelector);E(t,o),t.forEach((function(n){n.addEventListener("input",(function(){(function(e,t){t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(g.inputErrorClass),o.textContent="",o.classList.remove(g.inputErrorClassActive)}(e,t):function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add(g.inputErrorClass),n.textContent=o,n.classList.add(g.inputErrorClassActive)}(e,t,t.validationMessage)})(e,n),E(t,o)}))}))}(e)}));var P=document.querySelectorAll(".gallery-element__deletCard");console.log(P)})();